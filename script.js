// ===============================
// LISTA DE NOMES PERMITIDOS
// ===============================

// Este array guarda os nomes que podem acessar a carta.
// Se o nome digitado estiver aqui, a pessoa entra.
// Se n√£o estiver, o acesso √© negado.
const nomesPermitidos = ["thais","tata","thatha","thata","tais","ta√≠s"];
// Obs: pode adicionar mais nomes dentro das aspas, separados por v√≠rgula



// ===============================
// TEXTO DA CARTA
// ===============================

// Aqui est√° todo o texto da carta.
// Ele fica entre crases (` `), o que permite v√°rias linhas.
const carta = `
‚ÄúVoc√™ √© a mulher que eu tanto amo, e quero que tudo entre a gente aconte√ßa com calma e verdade.‚Äù

‚ÄúQuero deixar claro que n√£o √© um pedido de namoro. √â s√≥ a forma mais honesta que eu encontrei de
falar sobre o que eu sinto por voc√™. E, quem sabe, no futuro, depois da gente se conhecer melhor e se os
seus sentimentos forem rec√≠procos, isso possa virar algo a mais.‚Äù

Eu sou uma pessoa que nunca deixou ningu√©m entrar na minha vida. Durante muito tempo, constru√≠ muralhas ao redor do meu cora√ß√£o, acreditando que assim estaria protegido. Achei que ningu√©m jamais conseguiria atravessar essas barreiras‚Ä¶ at√© voc√™ chegar.

Sem perceber, voc√™ foi derrubando cada uma delas. No come√ßo, confesso, foi apenas curiosidade. Eu quis saber mais sobre voc√™, entender quem era essa mulher que despertava algo diferente em mim. Mas, com o passar do tempo, essa curiosidade foi crescendo, se transformando em cuidado, admira√ß√£o e, quando eu me dei conta, em amor.

Aos poucos, eu fui me apaixonando ‚Äî pelo seu sorriso, pelo seu olhar, pelo seu jeito √∫nico de ser. Sem perceber, voc√™ ocupou um espa√ßo que eu nunca havia permitido que ningu√©m ocupasse. Voc√™ tocou o meu cora√ß√£o de uma forma verdadeira, sincera e profunda, e mudou tudo dentro de mim.

Hoje, eu tenho certeza do que sinto. N√£o √© algo for√ßado, n√£o √© passageiro, n√£o √© ilus√£o. √â um sentimento real, que nasceu com o tempo, com a conviv√™ncia e com tudo o que voc√™ despertou em mim.

Eu confesso que sempre soube que esse caminho n√£o seria f√°cil. A sua irm√£ e o meu irm√£o j√° tinham me avisado que, se eu seguisse por ele, encontraria dificuldades. Mesmo assim, sabendo de tudo isso, eu n√£o consigo ‚Äî e n√£o quero ‚Äî desistir da mulher que eu amo.

Eu sei que talvez eu n√£o seja digno de voc√™, e reconhe√ßo isso com humildade. Voc√™ √© uma mulher esfor√ßada, maravilhosa, linda e inteligente. Eu te admiro profundamente pela mulher que voc√™ √© ‚Äî pela sua for√ßa, pela sua dedica√ß√£o, pelo seu car√°ter e pela sua ess√™ncia.

Eu sei que, muitas vezes, voc√™ tenta ser forte na frente das pessoas. Voc√™ segura, continua, sorri‚Ä¶ mas por dentro est√° chorando. E √© justamente a√≠ que eu quero estar.

Quero que voc√™ saiba, com toda a certeza do mundo, que voc√™ n√£o precisa carregar tudo sozinha comigo. Quando o cora√ß√£o apertar, quando faltar for√ßa, quando o sil√™ncio pesar, eu estarei aqui. Sempre. Para te ouvir, para te acolher, para te entender ‚Äî sem julgamentos, sem cobran√ßas, sem exig√™ncias.

Se um dia voc√™ precisar conversar, desabafar ou simplesmente ficar em sil√™ncio com algu√©m, voc√™ sabe onde me encontrar. Eu estarei aqui, de bra√ßos abertos, com o cora√ß√£o aberto, te esperando. Pronto para te apoiar em qualquer situa√ß√£o, em qualquer fase, em qualquer momento da sua vida.

Mesmo que voc√™ n√£o me escolha para caminhar ao seu lado nessa jornada da vida, mesmo que o seu caminho n√£o seja comigo, eu ainda assim estarei aqui. Porque o que eu sinto por voc√™ √© cuidado, √© respeito, √© amor verdadeiro.

E, acima de tudo, eu quero a sua felicidade ‚Äî do fundo do meu cora√ß√£o. Ainda que ela n√£o seja ao meu lado. O que importa para mim √© ver voc√™ bem, em paz, feliz. Porque voc√™ √© a mulher que eu tanto amo.

Voc√™ √© uma mulher reta, firme na f√© em nosso Deus, e eu tenho absoluta certeza de que voc√™ vai realizar todos os seus sonhos. Ver a sua determina√ß√£o s√≥ faz crescer ainda mais a admira√ß√£o, o respeito e o amor que eu sinto por voc√™.

Eu quero conhecer cada detalhe seu. Quero conhecer ainda mais a mulher por quem eu me apaixonei, saber dos seus pensamentos, dos seus medos, das suas alegrias. At√© mesmo esse seu lado ranzinza, do qual j√° ouvi falar pelo meu irm√£o e pela sua irm√£, eu quero conhecer ‚Äî porque tudo o que vem de voc√™ me importa.

Quero te conhecer com calma, sem pressa. Serei paciente. Vou respeitar o seu tempo, o seu espa√ßo e o seu ritmo. N√£o quero for√ßar nada, nem apressar nada. Quero caminhar ao seu lado, passo a passo, do jeito certo, do jeito que fizer sentido para voc√™.

Porque eu te amo. Eu sei que te conhe√ßo h√° pouco tempo, mas esse sentimento √© mais forte do que eu, e a cada dia ele s√≥ cresce. N√£o foi algo que eu escolhi sentir ‚Äî simplesmente aconteceu, de forma intensa, verdadeira e inevit√°vel.

Voc√™ √© a √∫nica pessoa para quem eu realmente me abri de verdade. A √∫nica que conheceu o meu verdadeiro eu, aquele lado que eu nunca mostrei para ningu√©m. Com voc√™, eu n√£o precisei fingir, nem esconder quem eu sou. Pela primeira vez, me senti seguro para ser eu mesmo.

Isso, para mim, tem um valor imenso. E √© por isso que o que sinto por voc√™ √© t√£o forte, t√£o sincero e t√£o real.

Com todo o meu amor,

R√¥mulo ‚Äî para Tha√≠s
`;



// ===============================
// FUN√á√ÉO NORMALIZAR TEXTO
// ===============================

// Esta fun√ß√£o serve para:
// - transformar tudo em letra min√∫scula
// - remover acentos
// Isso evita erro se a pessoa digitar "Tha√≠s", "thais" ou "THA√çS"
function normalizar(texto) {
  return texto
    .toLowerCase() // transforma tudo em min√∫sculo
    .normalize("NFD") // separa letras dos acentos
    .replace(/[\u0300-\u036f]/g, ""); // remove os acentos
}



// ===============================
// FUN√á√ÉO DE VERIFICA√á√ÉO DO NOME
// ===============================

// Essa fun√ß√£o roda quando a pessoa tenta entrar
function verificarNome() {
  const nome = document.getElementById("nameInput").value
    .toLowerCase()
    .normalize("NFD")
    .replace(/[\u0300-\u036f]/g, "");

  if (nome === "thais") {
    notificarAcesso(); // üìß AVISA VOC√ä

    document.getElementById("login").classList.add("hidden");
    document.getElementById("initialScreen").classList.remove("hidden");
  } else {
    document.getElementById("errorMsg").classList.remove("hidden");
  }
}



// ===============================
// FUN√á√ÉO DE DIGITA√á√ÉO DA CARTA
// ===============================

// Essa fun√ß√£o faz o efeito de "texto sendo digitado"
function digitarCarta() {

  // Elemento onde o texto vai aparecer
  const elemento = document.getElementById("typedText");

  // Limpa qualquer texto anterior
  elemento.innerHTML = '';

  // Contador de letras
  let i = 0;
  // Configura√ß√µes ajust√°veis:
  // Tempo entre cada caractere (ms). Reduza para digita√ß√£o mais r√°pida.
  const typingDelay = 20; // voc√™ pode alterar este valor

  // Intervalo m√≠nimo entre chamadas de scroll (ms) para evitar sobrecarga.
  const scrollInterval = 40;
  let lastScroll = 0;

  // Fun√ß√£o interna que escreve letra por letra usando n√≥s.
  // Faz scroll (throttled) para acompanhar as letras enquanto aparecem.
  function escrever() {
    if (i < carta.length) {
      const char = carta.charAt(i);
      let node;

      if (char === '\n') {
        // Insere quebra de linha e uma √¢ncora
        elemento.appendChild(document.createElement('br'));
        const anchor = document.createElement('span');
        anchor.className = 'line-anchor';
        elemento.appendChild(anchor);
        node = anchor;
      } else {
        // Insere caractere como n√≥ de texto
        const span = document.createElement('span');
        span.textContent = char;
        elemento.appendChild(span);
        node = span;
      }

      // Throttled scroll: apenas a cada `scrollInterval` ms
      const now = (typeof performance !== 'undefined' && performance.now) ? performance.now() : Date.now();
      if (now - lastScroll >= scrollInterval) {
        try {
          node.scrollIntoView({ behavior: 'smooth', block: 'end' });
        } catch (e) {
          window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
        }
        lastScroll = now;
      }

      i++;
      setTimeout(escrever, typingDelay);
    } else {
      // Quando terminar a carta, adicionar pausa e depois digitar o poema final
      setTimeout(() => {
        digitarPoemaFinal();
      }, 800); // pausa dram√°tica antes do poema
    }
  }

  escrever();

  // ===============================
  // FUN√á√ÉO PARA DIGITAR O POEMA FINAL
  // ===============================
  function digitarPoemaFinal() {
    // Adiciona quebras de linha antes do poema para separa√ß√£o
    elemento.appendChild(document.createElement('br'));
    elemento.appendChild(document.createElement('br'));

    // Conte√∫do do poema final (sem tags HTML)
    const poemaTexto = `E, se voc√™ chegou at√© aqui‚Ä¶

    Leia esse poema que eu fiz para voc√™.

Saiba que nada foi pressa,
nem promessa vazia.
Foi s√≥ verdade,
dita com cuidado.

Eu n√£o te pe√ßo nada,
al√©m do tempo.
Do tempo certo.
Do tempo que respeita.

Se for comigo,
caminho ao seu lado.
Se n√£o for,
ainda assim te desejo feliz.

Porque o que eu sinto
√© amor ‚Äî
calmo, sincero,
e real.

‚Äî R√¥mulo`;

    let poemaIndex = 0;

    function escreverPoema() {
      if (poemaIndex < poemaTexto.length) {
        const char = poemaTexto.charAt(poemaIndex);
        let node;

        if (char === '\n') {
          elemento.appendChild(document.createElement('br'));
          const anchor = document.createElement('span');
          anchor.className = 'line-anchor';
          elemento.appendChild(anchor);
          node = anchor;
        } else {
          const span = document.createElement('span');
          span.textContent = char;
          elemento.appendChild(span);
          node = span;
        }

        // Throttled scroll: acompanha o poema tamb√©m
        const now = (typeof performance !== 'undefined' && performance.now) ? performance.now() : Date.now();
        if (now - lastScroll >= scrollInterval) {
          try {
            node.scrollIntoView({ behavior: 'smooth', block: 'end' });
          } catch (e) {
            window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
          }
          lastScroll = now;
        }

        poemaIndex++;
        setTimeout(escreverPoema, typingDelay);
      }
    }

    escreverPoema();
  }
}



// ===============================
// EVENTOS AO CARREGAR A P√ÅGINA
// ===============================

// Esse bloco roda quando o HTML termina de carregar
document.addEventListener('DOMContentLoaded', function() {

  // ===============================
  // CLIQUE NA CARTA FECHADA
  // ===============================

  const cartaFechada = document.getElementById("cartaFechada");

  if (cartaFechada) {
    cartaFechada.addEventListener("click", () => {

      // Adiciona anima√ß√£o de abertura da carta
      cartaFechada.classList.add("abrir");

      const initialScreen = document.getElementById("initialScreen");

      // Anima√ß√£o de sumir a tela inicial
      initialScreen.classList.add("fadeOut");

      // Depois de 1.2 segundos
      setTimeout(() => {

        // Esconde a carta fechada
        initialScreen.classList.add("hidden");

        // Mostra a carta aberta
        document.getElementById("letter").classList.remove("hidden");

        // Libera o scroll da p√°gina
        document.body.style.overflow = 'auto';
        document.body.style.alignItems = 'flex-start';

        // Come√ßa a digitar a carta
        digitarCarta();

        // Rola suavemente para o topo
        setTimeout(() => {
          window.scrollTo({ top: 0, behavior: 'smooth' });
        }, 100);

        // Toca a m√∫sica (se existir)
        const music = document.getElementById("music");
        if (music) {
          music.play().catch(e => console.log("Erro ao reproduzir m√∫sica:", e));
        }

      }, 1200);
    });
  }



  // ===============================
  // ENTER PARA CONFIRMAR O NOME
  // ===============================

  const input = document.getElementById("nameInput");

  if (input) {
    input.addEventListener('keypress', function(e) {

      // Se apertar Enter
      if (e.key === 'Enter') {
        verificarNome();
      }
    });
  }
});
